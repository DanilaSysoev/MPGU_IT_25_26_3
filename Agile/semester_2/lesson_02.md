# Занятие №2: Архитектура приложения и UML

**Цель занятия:** Научить студентов проектировать структуру приложения *до* написания кода, познакомиться с базовыми обозначениями UML (классы, интерфейсы, наследование) и реализовать каркас игрового цикла (Game Loop).

**Продолжительность:** 180 минут.

---

## Часть 1. Ретроспектива и Лекция (80 минут)

### 1. Зачем нужна архитектура (15 мин)

* **Аналогия:** Строительство собачьей будки vs Строительство небоскреба.
  * Лабораторную работу на 100 строк (будку) можно строить без чертежа.
  * Игру (небоскреб) без чертежа строить нельзя — она рухнет под собственным весом, когда вы захотите добавить новую фичу.
* **SOLID:** Краткий тизер. "Мы будем учиться писать код так, чтобы добавление нового монстра не ломало логику ходьбы героя".

### 2. UML Class Diagram "на пальцах" (30 мин)

Не грузим всей спецификацией UML 2.0. Даем только то, что нужно для C#.

* **Прямоугольник:** Класс. 3 секции: Имя, Поля (Свойства), Методы.
* **Стрелки (Связи):**
  * **Наследование (Is-A):** Сплошная линия с пустым треугольником. (`Orc` -> `Enemy`). *Аналогия: Орк ЯВЛЯЕТСЯ Врагом.*
  * **Реализация (Can-Do):** Пунктирная линия с пустым треугольником. (`Player` - -> `IMovable`). *Аналогия: Игрок УМЕЕТ двигаться.*
  * **Ассоциация/Агрегация (Has-A):** Стрелка или Ромб. (`Inventory` <-> `Item`). *Аналогия: У Инвентаря ЕСТЬ Предметы.*
  * **Зависимость (Uses):** Пунктирная стрелка. (`Game` uses `Map`). *Аналогия: Игра ИСПОЛЬЗУЕТ Карту.*

### 3. Game Loop (Игровой цикл) (20 мин)

* Это сердце любой игры.
* **Паттерн:**

    ```csharp
    while (isRunning)
    {
        1. HandleInput(); // Читаем нажатия клавиш
        2. Update();      // Двигаем монстров, считаем физику
        3. Render();      // Рисуем кадр в консоли
    }
    ```

---

## Часть 2. Воркшоп / Практическое задание

**Тема:** Проектирование и создание каркаса.

### Легенда

Заказчик (преподаватель) требует утвердить архитектуру перед началом активной разработки. Вы должны предоставить "чертеж" игры и разложить "фундамент" (классы) в проекте.

### Инструменты

* Mermaid.js
* Visual Studio Code

### Задание пошагово

1. **Проектирование (UML):**

    * Нарисовать диаграмму классов для своей игры. Пример набора сущностей:
      * `Game` (управляет циклом).
      * `Map` / `Level` (хранит состояние мира).
      * `Entity` (базовый класс для всех живых объектов).
      * `Player` и `Enemy` (наследники Entity).
      * `Item` (предмет).
    * Показать связи.
2. **Структура проекта (Solution):**
    * В Visual Studio Code создать папки (Filter/Folders) для организации кода. Не сваливать все файлы в корень!
      * Пример: `/Core`, `/Entities`, `/Items`, `/Systems`.
3. **Реализация каркаса (Code):**
    * Создать классы согласно диаграмме (пока пустые или с базовыми свойствами `Health`, `Name`).
    * **Правило:** 1 класс = 1 файл.
4. **Game Loop:**
    * В классе `Program.cs` или `Game.cs` реализовать бесконечный цикл `while`.
    * Внутри цикла вызывать методы `Update()` и `Draw()`.
    * Сделать выход из цикла по нажатию `Esc`.

**Дедлайн:** 1 неделя.

---

## Критерии оценивания (Максимум 8 баллов)

| Критерий | Баллы | Описание |
| :--- | :---: | :--- |
| **UML Диаграмма** | **3** | Схема есть (картинка в корне репо или в PDF). На схеме корректно показано наследование (`Player` -> `Entity`) и ассоциации. Минимум 5 классов. |
| **Структура проекта** | **2** | Код разбит по папкам (namespace'ам). Соблюдается правило "1 файл = 1 класс". Имена файлов соответствуют именам классов. |
| **Game Loop** | **1** | Приложение запускается, крутится в цикле, реагирует на ввод (например, выход по `Esc` или вывод текста при нажатии клавиш). |
| **Качество кода (Style)** | **1** | Правильный нейминг (PascalCase для классов/методов). Нет транслита (`class Oruzhie`). |
| **Git / Docs** | **1** | Работа сделана в отдельной ветке. Есть Pull Request / Merge. Коммиты осмысленные. |
| **Итого** | **8** | |

### Штрафы (Вычитаются из суммы)

* **Все в одном файле:** `-2 балла`. Если все классы записаны внутри `Program.cs`. Это моветон.
* **Транслит:** `-1 балл`. Переменные типа `int zhizn`, `class Vrag`. Код пишем на английском.
* **Мертвый цикл:** `-1 балл`. Если из цикла игры невозможно выйти штатно (только закрыв окно консоли "крестиком").
* **Нет диаграммы:** `-3 балла`. Сразу минус за невыполнение архитектурной части.

---
